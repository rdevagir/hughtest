{"nodes":{"Extract_PricebookEntry":{"action":"sobjectDigest","parameters":{"fields":[{"name":"Id"},{"name":"Product2Id"}],"object":"PricebookEntry","passthroughFilter":"External_Id__c LIKE 'W_PricebookEntry.%'","runtime":{"SFDCtoken":"SFDCtoken"}}},"Filter_ForecastQuota":{"action":"filter","parameters":{"filter":"Type.DeveloperName:EQ:OpportunityRevenue"},"sources":["Join_ForecastQuota_ForecastType"]},"Extract_Opportunity":{"action":"sobjectDigest","parameters":{"fields":[{"name":"Id"},{"name":"AccountId"},{"name":"OwnerId"},{"name":"Name"},{"name":"StageName"},{"name":"LeadSource"},{"name":"IsWon"},{"name":"Type"},{"name":"IsClosed"},{"name":"ForecastCategory"},{"name":"ForecastCategoryName"},{"name":"DateTimeCreated__c"},{"firstDayOfWeek":0,"fiscalMonthOffset":0,"name":"CloseDate"},{"name":"Amount"},{"name":"CreatedById"},{"name":"LastModifiedDate__c"},{"name":"LastActivityDate__c"},{"name":"HasOpportunityLineItem"},{"name":"RecordTypeId"}],"object":"Opportunity","passthroughFilter":"External_ID__c LIKE 'W_Opportunity.%'","runtime":{"SFDCtoken":"SFDCtoken"}}},"Extract_Product":{"action":"sobjectDigest","parameters":{"fields":[{"name":"Id"},{"name":"ProductCode"},{"name":"Name"},{"name":"Family"}],"object":"Product2","passthroughFilter":"External_ID__c LIKE 'W_Product.%'","runtime":{"SFDCtoken":"SFDCtoken"}}},"Join_LeadOwner":{"action":"augment","parameters":{"leftKey":["OwnerId"],"relationship":"Owner","rightKey":["Id"],"rightSelect":["Name","Username","UserRoleId","UserManager.Name","UserManagerNames","UniqueUserName","UserManager.UniqueUserName","FullPhotoUrl","SmallPhotoUrl","Role.Name","Role.DeveloperName","Role.Roles","Role.RolePath","Role.ParentRoleId","Role.ParentRole.Name","Role.ParentRole.DeveloperName","Role.RoleNames","Role.RoleNamesPath"]},"sources":["Compute_CurrentDateForLeads","User_with_Roles"]},"Join_LeadOwnerOpportunity":{"action":"augment","parameters":{"leftKey":["ConvertedOpportunityId"],"relationship":"ConvertedOpportunity","rightKey":["Id"],"rightSelect":["Name","StageName","CloseDate","IsWon","Type","IsClosed","LeadSource","ForecastCategory","ForecastCategoryName","CreatedDate","AccountId","OwnerId","Owner.Name","Owner.UserManager.Name","Owner.UserManagerNames","Owner.UserManager.UniqueUserName","Owner.UniqueUserName","Owner.Role.Name","Owner.Role.DeveloperName","Owner.Role.Roles","Owner.Role.RolePath","Owner.Role.ParentRoleId","OpportunityAge","DaysSinceLastActivity","Neglected"]},"sources":["Compute_Lead_Name_or_Queue","Join_OpportunityOwner"]},"Join_User_Manager":{"action":"augment","parameters":{"leftKey":["Id"],"relationship":"UserManager","rightKey":["ManagerId"],"rightSelect":["Name","Username","FullPhotoUrl","SmallPhotoUrl","UserRoleId","Id","UniqueUserName"]},"sources":["Compute_Manager_Unique","Compute_Manager_Unique"]},"Compute_CurrentDateForLeads":{"action":"computeExpression","parameters":{"computedFields":[{"format":"yyyy-MM-dd'T'HH:mm:ss.SSS'Z'","label":"CurrentDate","name":"CurrentDate","saqlExpression":"now()","type":"Date"}],"mergeWithSource":true},"sources":["add_standard_Extract_Lead"]},"Join_ActivityOwner_Product_Opp_User":{"action":"augment","parameters":{"leftKey":["OwnerId"],"relationship":"AssignedTo","rightKey":["Id"],"rightSelect":["Name","UniqueUserName"]},"sources":["Join_ActivityOwner_Product_Opp","Flatten_UserManager"]},"Extract_Case":{"action":"sobjectDigest","parameters":{"fields":[{"name":"AccountId"},{"name":"ContactId"},{"name":"OwnerId"},{"name":"Id"},{"name":"IsClosed"},{"name":"Origin"},{"name":"Type"},{"name":"Subject"},{"firstDayOfWeek":0,"fiscalMonthOffset":0,"name":"LastModifiedDate"},{"firstDayOfWeek":0,"fiscalMonthOffset":0,"name":"CreatedDate__c"},{"firstDayOfWeek":0,"fiscalMonthOffset":0,"name":"ClosedDate__c"},{"name":"IsEscalated"},{"name":"Status"},{"name":"CaseNumber"}],"object":"Case","passthroughFilter":"External_ID__c LIKE 'W_Sales_Case.%'"}},"Extract_OpportunityStage":{"action":"sobjectDigest","parameters":{"fields":[{"name":"IsClosed"},{"firstDayOfWeek":0,"fiscalMonthOffset":0,"name":"CreatedDate"},{"name":"Description"},{"name":"ForecastCategory"},{"name":"ForecastCategoryName"},{"name":"IsActive"},{"firstDayOfWeek":0,"fiscalMonthOffset":0,"name":"LastModifiedDate"},{"name":"MasterLabel"},{"name":"Id"},{"name":"DefaultProbability"},{"name":"SortOrder"},{"name":"SystemModstamp"},{"name":"IsWon"}],"object":"OpportunityStage"}},"Join_OpportunityStage_Previous_with_Opp":{"action":"augment","parameters":{"leftKey":["OpportunityId"],"relationship":"Opportunity","rightKey":["Id"],"rightSelect":["Name","Type","IsWon","IsClosed","Stage.SortOrder","OwnerId","AccountId","CloseDate","StageName","LeadSource","ForecastCategoryName","Account.Name","Account.Type","Account.Industry","Account.AccountSource","Account.ShippingState","Account.BillingState","Account.OwnerId","Account.Owner.Name","Owner.Name","Owner.FullPhotoUrl","Owner.SmallPhotoUrl","Owner.UserManager.Name","Owner.UserManagerNames","Owner.UserManager.UniqueUserName","Owner.UniqueUserName","Owner.Role.RoleNames","Owner.Role.Name","Owner.Role.DeveloperName","Owner.Role.Roles","Owner.Role.RolePath","Owner.Role.ParentRoleId","Owner.Role.ParentRole.Name","Owner.Role.ParentRole.DeveloperName","RecordTypeId","RecordType.Name"]},"sources":["Join_Time_In_Current_Stage_to_Pipeline_Trending","Join_OpportunityOwner"]},"Join_OpportunityStage_Previous_with_Opp_Amount":{"action":"augment","parameters":{"leftKey":["OpportunityId"],"relationship":"Opportunity","rightKey":["Id"],"rightSelect":["Amount"]},"sources":["Join_OpportunityStage_Previous_with_Opp","Extract_OpportunityAmount"]},"Extract_Lead":{"action":"sobjectDigest","parameters":{"fields":[{"name":"Id"},{"name":"Name"},{"name":"OwnerId"},{"defaultValue":"N/A","name":"Company"},{"name":"ConvertedAccountId"},{"name":"ConvertedContactId"},{"name":"ConvertedDate__c"},{"name":"ConvertedOpportunityId"},{"fiscalMonthOffset":0,"name":"CreatedDate__c"},{"firstDayOfWeek":0,"fiscalMonthOffset":0,"name":"LastModifiedDate"},{"name":"IsConverted"},{"name":"IsUnreadByOwner"},{"defaultValue":"N/A","name":"Status"},{"defaultValue":"N/A","name":"LeadSource"},{"defaultValue":"N/A","name":"Rating"},{"defaultValue":"N/A","name":"Industry"},{"defaultValue":"N/A","name":"State"}],"object":"Lead","passthroughFilter":"External_ID__c LIKE 'W_Lead.%'","runtime":{"SFDCtoken":"SFDCtoken"}}},"Join_Time_In_Current_Stage_to_Pipeline_Trending":{"action":"augment","parameters":{"leftKey":["OpportunityId"],"relationship":"Time_In_Current_Stage","rightKey":["OpportunityId"],"rightSelect":["Duration_Seconds"]},"sources":["Join_ForecastCategory_Previous","Calculate_Current_Stage_Duration"]},"User_with_Roles_Forecasting_Hierarchy":{"action":"augment","parameters":{"leftKey":["UniqueUserName"],"relationship":"Role","rightKey":["UniqueUserName"],"rightSelect":["RoleNames","RoleNamesPath"]},"sources":["Flatten_UserManager","Flatten_ParentName"]},"Join_OpportunityStage":{"action":"augment","parameters":{"leftKey":["StageName"],"relationship":"Stage","rightKey":["MasterLabel"],"rightSelect":["IsClosed","IsWon","SortOrder"]},"sources":["Add_Fields_to_OpportunityHistory","Extract_OpportunityStage"]},"Join_ActivityOwner_Product":{"action":"augment","parameters":{"leftKey":["WhatId"],"operation":"LookupMultiValue","relationship":"Opportunity","rightKey":["OpportunityId"],"rightSelect":["Product.Family","Product.Name"]},"sources":["Join_ActivityOwner","Join_OpportunityOpportunityLineItemPricebookEntryProduct"]},"Register_Activity":{"action":"register","parameters":{"label":"Activities","name":"activity","rowLevelSecurityFilter":"'Owner.Role.Roles' == \"$User.UserRoleId\" || 'OwnerId' == \"$User.Id\" || 'Opportunity.Account.OwnerId' == \"$User.Id\"","runtime":{"SFDCtoken":"SFDCtoken"}},"sources":["Filter_Activity"]},"Calculate_Current_Stage_Duration":{"action":"computeExpression","parameters":{"computedFields":[{"label":"Duration","name":"Duration_Seconds","precision":18,"saqlExpression":"date_diff(\"second\",toDate(ValidFromDate_sec_epoch), now())","scale":0,"type":"Numeric"}],"mergeWithSource":true},"sources":["Filter_Out_Last_Stage_Updates"]},"Compute_Activity_IsOverdue":{"action":"computeExpression","parameters":{"computedFields":[{"label":"IsOverdue","name":"IsOverdue","saqlExpression":"case when ('IsClosed' == \"false\") && (daysBetween(toDate(substr('ActivityDate', 1, 10), \"yyyy-MM-dd\"), now()) > 0) then \"true\" else \"false\" end","type":"Text"}],"mergeWithSource":true},"sources":["Join_ActivityOwner_Product_Opp_User_Account"]},"Register_UserRole":{"action":"register","parameters":{"label":"Roles","name":"user_role","runtime":{"SFDCtoken":"SFDCtoken"}},"sources":["Flatten_ParentName"]},"Join_Role_on_ForecastUser":{"action":"augment","parameters":{"leftKey":["UserRoleId"],"relationship":"Role","rightKey":["Id"],"rightSelect":["Name","ParentRoleId","ParentRole.Name","ForecastManager.Name","ForecastManager.UniqueUserName","ParentRole.ForecastManager.Name","ParentRole.ForecastManager.UniqueUserName"]},"sources":["Filter_For_Forecast_Users","Augment_ParentName"]},"compute_CurrentDateForCase":{"action":"computeExpression","parameters":{"computedFields":[{"format":"yyyy-MM-dd'T'HH:mm:ss.SSS'Z'","label":"CurrentDate","name":"CurrentDate","saqlExpression":"now()","type":"Date"}],"mergeWithSource":true},"sources":["add_standard_Extract_Case"]},"Augment_ParentName":{"action":"augment","parameters":{"leftKey":["ParentRoleId"],"relationship":"ParentRole","rightKey":["Id"],"rightSelect":["Name","DeveloperName","ForecastManager.Name","ForecastManager.UniqueUserName","ForecastManager.ForecastEnabled","ParentRoleId"]},"sources":["Flatten_UserRole","Join_RoleUser"]},"Create_IsLastStageUpdate_Field":{"action":"computeExpression","parameters":{"computedFields":[{"label":"IsLastStageUpdate","name":"IsLastStageUpdate","saqlExpression":"case when 'LastStageUpdate_Id' == 'Id' then \"1\" else \"0\" end","type":"Text"}],"mergeWithSource":true},"sources":["Find_Last_Stage_Updates"]},"Join_OpportunityOpportunityStage":{"action":"augment","parameters":{"leftKey":["StageName"],"relationship":"Stage","rightKey":["MasterLabel"],"rightSelect":["SortOrder","DefaultProbability"]},"sources":["Add_Neglected_To_Opportunity","Extract_OpportunityStage"]},"Add_Fields_To_Account":{"action":"computeExpression","parameters":{"computedFields":[{"label":"Account Name","name":"AccountName","saqlExpression":"'Name'","type":"Text"}],"mergeWithSource":true},"sources":["Extract_Account"]},"Filter_Opportunity_Products":{"action":"filter","parameters":{"filter":"CustomFilter:EQ:true"},"sources":["Opportunity_Products_Custom_Filter_Flag"]},"rename_OpportunityHistoryFields":{"action":"computeExpression","parameters":{"computedFields":[{"label":"Amount","name":"Amount","precision":18,"saqlExpression":"'Amount__c'","scale":2,"type":"Numeric"},{"format":"yyyy-MM-dd'T'HH:mm:ss.SSS'Z'","label":"CreatedDate","name":"CreatedDate","saqlExpression":"toDate(CreatedDate__c, \"yyyy-MM-dd'T'HH:mm:ss.SSS'Z'\")","type":"Date"},{"format":"yyyy-MM-dd","label":"CloseDate","name":"CloseDate","saqlExpression":"toDate(CloseDate__c, \"yyyy-MM-dd\")","type":"Date"},{"name":"ForecastCategory","saqlExpression":"ForecastCategory__c","type":"Text"},{"name":"OpportunityId","saqlExpression":"OpportunityId__c","type":"Text"},{"name":"StageName","saqlExpression":"StageName__c","type":"Text"}],"mergeWithSource":true},"sources":["Extract_OpportunityHistory"]},"add_standard_Extract_Account":{"action":"computeExpression","parameters":{"computedFields":[{"format":"yyyy-MM-dd'T'HH:mm:ss.SSS'Z'","label":"CreatedDate","name":"CreatedDate","saqlExpression":"toDate(CreatedDate__c, \"yyyy-MM-dd'T'HH:mm:ss.SSS'Z'\")","type":"Date"}],"mergeWithSource":true},"sources":["Extract_Account"]},"Filter_Out_Stage_Updates":{"action":"filter","parameters":{"filter":"Stage_isUpdated:EQ:1"},"sources":["Add_Fields_to_OpportunityHistory"]},"Compute_Activity_Days_Overdue":{"action":"computeExpression","parameters":{"computedFields":[{"defaultValue":"0","label":"Days Overdue","name":"DaysOverdue","precision":18,"saqlExpression":"case when 'IsOverdue' == \"true\" then daysBetween(toDate(substr('ActivityDate', 1, 10), \"yyyy-MM-dd\"), now()) else 0 end","scale":2,"type":"Numeric"}],"mergeWithSource":true},"sources":["Compute_Activity_IsOverdue"]},"Discount_Field":{"action":"computeExpression","parameters":{"computedFields":[{"name":"Discount_Percent","precision":7,"saqlExpression":"1-(('TotalPrice')/('ListPrice' * 'Quantity'))","scale":6,"type":"Numeric"},{"name":"Total_ListPrice","precision":7,"saqlExpression":"'ListPrice' * 'Quantity'","scale":6,"type":"Numeric"}],"mergeWithSource":true},"sources":["Extract_OpportunityLineItem"]},"Filter_Opportunity":{"action":"filter","parameters":{"filter":"CustomFilter:EQ:true"},"sources":["Opportunity_Custom_Filter_Flag"]},"Join_ForecastCategory":{"action":"augment","parameters":{"leftKey":["ForecastCategory"],"relationship":"ForecastCategory","rightKey":["ForecastCategory"],"rightSelect":["ForecastCategoryName"]},"sources":["Join_OpportunityStage_Previous","Extract_OpportunityStage"]},"Compute_Manager_Unique":{"action":"computeExpression","parameters":{"computedFields":[{"name":"UniqueUserName","saqlExpression":"case when isDuplicate is null then 'Name' else 'Name' + \" (\" +'Username'+ \")\" end","type":"Text"}],"mergeWithSource":true},"sources":["Compute_Unique_Name"]},"Join_LeadQueue":{"action":"augment","parameters":{"leftKey":["OwnerId"],"relationship":"Queue","rightKey":["Id"],"rightSelect":["Name","Type"]},"sources":["Join_LeadOwner","Extract_Queue"]},"Join_OpportunityLineItemPricebookEntry":{"action":"augment","parameters":{"leftKey":["PricebookEntryId"],"relationship":"Pricebook","rightKey":["Id"],"rightSelect":["Product2Id"]},"sources":["Discount_Field","Extract_PricebookEntry"]},"Extract_Task":{"action":"sobjectDigest","parameters":{"fields":[{"name":"Id"},{"name":"CallDurationInSeconds"},{"name":"CallDisposition"},{"name":"CallType"},{"name":"OwnerId"},{"name":"Status"},{"name":"Priority"},{"name":"IsClosed"},{"name":"TaskSubtype"},{"name":"CreatedDate__c"},{"firstDayOfWeek":0,"fiscalMonthOffset":0,"name":"ActivityDate"},{"firstDayOfWeek":0,"fiscalMonthOffset":0,"name":"LastModifiedDate"},{"name":"Subject"},{"name":"WhatId"},{"name":"AccountId"}],"object":"Task","passthroughFilter":"External_ID__c LIKE 'W_Sales_Task.%'"}},"Join_AccountOwner":{"action":"augment","parameters":{"leftKey":["OwnerId"],"relationship":"Owner","rightKey":["Id"],"rightSelect":["Name","Username","UserRoleId","UserManager.Name","UserManagerNames","UniqueUserName","UserManager.UniqueUserName","FullPhotoUrl","SmallPhotoUrl","Role.Name","Role.DeveloperName","Role.Roles","Role.RolePath","Role.ParentRoleId","Role.ParentRole.Name","Role.ParentRole.DeveloperName","Role.RoleNames","Role.RoleNamesPath"]},"sources":["Add_Fields_To_Account","User_with_Roles"]},"Join_RoleUser":{"action":"augment","parameters":{"leftKey":["ForecastUserId"],"relationship":"ForecastManager","rightKey":["Id"],"rightSelect":["Name","UniqueUserName","ForecastEnabled"]},"sources":["Extract_UserRole","Filter_For_Forecast_Users"]},"Append_TaskEvent":{"action":"append","parameters":{},"sources":["Add_Fields_To_Task","Add_Fields_To_Event"]},"Join_ForecastCategory_Previous":{"action":"augment","parameters":{"leftKey":["ForecastCategory"],"relationship":"ForecastCategoryPrev","rightKey":["ForecastCategory"],"rightSelect":["ForecastCategoryName"]},"sources":["Join_ForecastCategory","Extract_OpportunityStage"]},"Add_Fields_to_OpportunityHistory":{"action":"computeExpression","parameters":{"computedFields":[{"defaultValue":"\"1\"","name":"Stage_isUpdated","saqlExpression":"case when 'StageName' == 'StageNamePrev' then \"0\" else \"1\" end","type":"Text"},{"defaultValue":"\"1\"","name":"CloseDate_isUpdated","saqlExpression":"case when 'CloseDatePrev' == 'CloseDate' then \"0\" else \"1\" end","type":"Text"},{"defaultValue":"\"1\"","name":"Amount_isUpdated","saqlExpression":"case when 'AmountPrev' == 'Amount' then \"0\" else \"1\" end","type":"Text"},{"label":"IsLastUpdate","name":"IsLastUpdate","saqlExpression":"case when 'ValidToDate' == \"3000-01-01T00:00:00.000Z\" then \"1\" else \"0\" end","type":"Text"},{"name":"IsPushed","precision":8,"saqlExpression":"case when ('CloseDatePrev' != \"1970-1-1\") && ('CloseDatePrev' < 'CloseDate') then 1 else 0 end","scale":0,"type":"Numeric"},{"name":"IsPulled","precision":8,"saqlExpression":"case when ('CloseDatePrev' != \"1970-1-1\") && ('CloseDatePrev' > 'CloseDate') then 1 else 0 end","scale":0,"type":"Numeric"},{"label":"Duration","name":"Duration","precision":18,"saqlExpression":"case when 'ValidToDate' == \"3000-01-01T00:00:00.000Z\" then     date_diff(\"second\",toDate(ValidFromDate_sec_epoch), now())     else     date_diff(\"second\",toDate(ValidFromDate_sec_epoch), toDate(ValidToDate_sec_epoch))     end","scale":0,"type":"Numeric"}],"mergeWithSource":true},"sources":["Compute_Historical_Trending_Fields"]},"Register_Account":{"action":"register","parameters":{"label":"Accounts","name":"account","rowLevelSecurityFilter":"'Owner.Role.Roles' == \"$User.UserRoleId\" || 'OwnerId' == \"$User.Id\"","runtime":{"SFDCtoken":"SFDCtoken"}},"sources":["Filter_Account"]},"Join_OpportunityOwner":{"action":"augment","parameters":{"leftKey":["OwnerId"],"relationship":"Owner","rightKey":["Id"],"rightSelect":["Name","Username","UserRoleId","UserManager.Name","UserManagerNames","UniqueUserName","UserManager.UniqueUserName","FullPhotoUrl","SmallPhotoUrl","Role.Name","Role.DeveloperName","Role.Roles","Role.RolePath","Role.ParentRoleId","Role.ParentRole.Name","Role.ParentRole.DeveloperName","Role.RoleNames","Role.RoleNamesPath"]},"sources":["Join_OpportunityAccount","User_with_Roles"]},"Join_CaseAccount_Oppty":{"action":"augment","parameters":{"leftKey":["AccountId"],"operation":"LookupMultiValue","relationship":"Opportunity","rightKey":["AccountId"],"rightSelect":["Amount"]},"sources":["Join_CaseAccount","Filter_WonOppty"]},"Compute_Unique_Name":{"action":"computeRelative","parameters":{"computedFields":[{"description":"isDuplicate","expression":{"offset":"next()","sourceField":"Id"},"label":"isDuplicate","name":"isDuplicate"}],"orderBy":[{"direction":"asc","name":"Id"}],"partitionBy":["Name"]},"sources":["Filter_User"]},"Add_Fields_To_Event":{"action":"computeExpression","parameters":{"computedFields":[{"label":"CallDisposition","name":"CallDisposition","saqlExpression":"\"Event\"","type":"Text"},{"label":"CallType","name":"CallType","saqlExpression":"\"Event\"","type":"Text"},{"label":"Status","name":"Status","saqlExpression":"\"Event\"","type":"Text"},{"label":"Priority","name":"Priority","saqlExpression":"\"Event\"","type":"Text"},{"label":"TaskSubtype","name":"TaskSubtype","saqlExpression":"EventSubtype","type":"Text"},{"defaultValue":"0","label":"CallDurationInSeconds","name":"CallDurationInSeconds","precision":8,"saqlExpression":"0","scale":0,"type":"Numeric"},{"label":"IsClosed","name":"IsClosed","saqlExpression":"case when daysBetween(toDate(ActivityDate_sec_epoch), now()) >= 0 then \"true\" else \"false\" end","type":"Text"}],"mergeWithSource":true},"sources":["add_standard_Extract_Event"]},"Join_ActivityOwner_Product_Opp_User_Account":{"action":"augment","parameters":{"leftKey":["AccountId"],"relationship":"Account","rightKey":["Id"],"rightSelect":["Name","Type","Industry","BillingState","ShippingState","AccountSource","NumberOfEmployees","AnnualRevenue","OwnerId","Owner.Name","Owner.UserManager.Name","Owner.UserManagerNames","Owner.UserManager.UniqueUserName","Owner.UniqueUserName","Owner.Role.Name","Owner.Role.Roles","Owner.Role.RolePath","Owner.Role.ParentRoleId"]},"sources":["Join_ActivityOwner_Product_Opp_User","Join_AccountOwner"]},"Users_Custom_Filter_Flag":{"action":"computeExpression","parameters":{"computedFields":[{"name":"hasOpportunity","saqlExpression":"case when 'Opportunity.Name' is null then \"false\" else \"true\" end","type":"Text"},{"name":"CustomFilter","saqlExpression":"case when 'Opportunity.Name' is null && 'IsActive' == \"false\" then \"false\" else \"true\" end","type":"Text"}],"mergeWithSource":true},"sources":["User_with_Roles_with_Opportunities"]},"Join_ForecastQuota_ForecastType":{"action":"augment","parameters":{"leftKey":["ForecastingTypeId"],"relationship":"Type","rightKey":["Id"],"rightSelect":["IsActive","DeveloperName","IsAmount","IsQuantity"]},"sources":["Extract_ForecastingQuota","Extract_ForecastingType"]},"Join_OpportunityAccount":{"action":"augment","parameters":{"leftKey":["AccountId"],"relationship":"Account","rightKey":["Id"],"rightSelect":["Name","Type","Industry","BillingState","ShippingState","AccountSource","NumberOfEmployees","AnnualRevenue","OwnerId","Owner.Name","Owner.UserManager.Name","Owner.UserManagerNames","Owner.UserManager.UniqueUserName","Owner.UniqueUserName","Owner.Role.Name","Owner.Role.Roles","Owner.Role.RolePath","Owner.Role.ParentRoleId"]},"sources":["Create_StageName_Multi_Value_Key","Join_AccountOwner"]},"Register_QuotaWithRoles":{"action":"register","parameters":{"label":"User Allocation","name":"quota","rowLevelSecurityFilter":"'User.Role.Roles' == \"$User.UserRoleId\" || 'User.Id' == \"$User.Id\"","runtime":{"SFDCtoken":"SFDCtoken"}},"sources":["Join_Quota_User"]},"Filter_Account":{"action":"filter","parameters":{"filter":"CustomFilter:EQ:true"},"sources":["Account_Custom_Filter_Flag"]},"Filter_User":{"action":"filter","parameters":{"filter":"UserType:EQ:Standard|PowerPartner"},"sources":["Extract_User"]},"Join_OpportunityRecordType":{"action":"augment","parameters":{"leftKey":["RecordTypeId"],"relationship":"RecordType","rightKey":["Id"],"rightSelect":["Name"]},"sources":["Join_OpportunityOpportunityStage","Extract_RecordTypes"]},"Opportunity_Custom_Filter_Flag":{"action":"computeExpression","parameters":{"computedFields":[{"name":"CustomFilter","saqlExpression":"\"true\"","type":"Text"}],"mergeWithSource":true},"sources":["Join_OpportunityOwner_Product"]},"Compute_Historical_Trending_Fields":{"action":"computeRelative","parameters":{"computedFields":[{"description":"Opportunity Created Date","expression":{"offset":"first()","sourceField":"CreatedDate","default":"current()"},"label":"OpportunityCreatedDate","name":"OpportunityCreatedDate"},{"description":"ValidToDate","expression":{"offset":"next()","sourceField":"CreatedDate","default":"3000-01-01T00:00:00.000Z"},"label":"ValidToDate","name":"ValidToDate"},{"description":"ValidFromDate","expression":{"offset":"current()","sourceField":"CreatedDate","default":"current()"},"label":"ValidFromDate","name":"ValidFromDate"},{"description":"AmountPrev","expression":{"offset":"previous()","sourceField":"Amount","default":"0"},"label":"AmountPrev","name":"AmountPrev"},{"description":"Previous Stage Name","expression":{"offset":"previous()","sourceField":"StageName"},"label":"Prev Stage Name","name":"StageNamePrev"},{"description":"ForecastCategoryPrev","expression":{"offset":"previous()","sourceField":"ForecastCategory"},"label":"ForecastCategoryPrev","name":"ForecastCategoryPrev"},{"description":"Previous Close Date","expression":{"offset":"previous()","sourceField":"CloseDate","default":"1970-01-01"},"label":"Prev Close Date","name":"CloseDatePrev"},{"description":"Previous Created Date","expression":{"offset":"previous()","sourceField":"CreatedDate"},"label":"Prev CreatedDate","name":"CreatedDatePrev"}],"orderBy":[{"direction":"asc","name":"CreatedDate"}],"partitionBy":["OpportunityId"]},"sources":["rename_OpportunityHistoryFields"]},"Extract_RecordTypes":{"action":"sobjectDigest","parameters":{"fields":[{"name":"Name"},{"name":"Id"}],"object":"RecordType"}},"Flatten_ParentName":{"action":"flatten","parameters":{"includeSelfId":true,"multiField":{"isSystemField":false,"label":"RoleNames","name":"RoleNames"},"parentField":"Role.ParentRole.ForecastManager.UniqueUserName","pathField":{"isSystemField":false,"label":"RoleNamesPath","name":"RoleNamesPath"},"selfField":"UniqueUserName"},"sources":["Join_Role_on_ForecastUser"]},"Join_Quota_User":{"action":"augment","parameters":{"leftKey":["QuotaOwnerId"],"relationship":"User","rightKey":["Id"],"rightSelect":["Id","Name","Username","UserRoleId","UserManager.Name","UserManagerNames","UniqueUserName","UserManager.UniqueUserName","FullPhotoUrl","SmallPhotoUrl","Role.Name","Role.DeveloperName","Role.Roles","Role.RolePath","Role.ParentRoleId","Role.ParentRole.Name","Role.ParentRole.DeveloperName","Role.RoleNames","Role.RoleNamesPath"]},"sources":["Filter_ForecastQuota","User_with_Roles"]},"Extract_Account":{"action":"sobjectDigest","parameters":{"fields":[{"name":"Id"},{"name":"Name"},{"name":"OwnerId"},{"name":"NumberOfEmployees"},{"name":"AnnualRevenue"},{"name":"AccountSource"},{"name":"Type"},{"name":"Industry"},{"name":"BillingState"},{"name":"ShippingState"},{"name":"CreatedDate__c"},{"firstDayOfWeek":0,"fiscalMonthOffset":0,"name":"LastModifiedDate"}],"object":"Account","passthroughFilter":"External_ID__c LIKE 'W_Account.%'","runtime":{"SFDCtoken":"SFDCtoken"}}},"Register_ForecastingItem":{"action":"register","parameters":{"label":"ForecastingItem","name":"forecasting_item","rowLevelSecurityFilter":"'User.Role.Roles' == \"$User.UserRoleId\" || 'User.Id' == \"$User.Id\"","runtime":{"SFDCtoken":"SFDCtoken"}},"sources":["Join_ForecastingItem_Period_User_Type"]},"Compute_Lead_Name_or_Queue":{"action":"computeExpression","parameters":{"computedFields":[{"label":"Owner or Queue Name","name":"UserOrQueueName","saqlExpression":"case when 'Owner.Name' is null && !('Queue.Name' is null) then 'Queue.Name' when !('Owner.Name' is null) then 'Owner.Name' else \"N/A\" end","type":"Text"},{"label":"Owner Type","name":"OwnerType","saqlExpression":"case when 'Owner.Name' is null && !('Queue.Name' is null) then \"Queue\" when !('Owner.Name' is null) then \"User\" else \"N/A\" end","type":"Text"}],"mergeWithSource":true},"sources":["Join_LeadQueue"]},"Extract_UserRole":{"action":"sobjectDigest","parameters":{"fields":[{"name":"Id"},{"name":"Name"},{"name":"DeveloperName"},{"name":"ParentRoleId"},{"firstDayOfWeek":0,"fiscalMonthOffset":0,"name":"LastModifiedDate"},{"name":"LastModifiedById"},{"name":"ForecastUserId"},{"name":"SystemModstamp"}],"object":"UserRole","runtime":{"SFDCtoken":"SFDCtoken"}}},"User_with_Roles":{"action":"augment","parameters":{"leftKey":["UserRoleId"],"relationship":"Role","rightKey":["Id"],"rightSelect":["Name","DeveloperName","Roles","RolePath","ParentRoleId","ParentRole.Name","ParentRole.DeveloperName","ParentRole.ForecastManager.Name","ParentRole.ForecastManager.UniqueUserName","ForecastManager.Name","ForecastManager.UniqueUserName","ForecastManager.ForecastEnabled"]},"sources":["User_with_Roles_Forecasting_Hierarchy","Augment_ParentName"]},"Pipeline_Trending_Custom_Filter_Flag":{"action":"computeExpression","parameters":{"computedFields":[{"name":"CustomFilter","saqlExpression":"\"true\"","type":"Text"}],"mergeWithSource":true},"sources":["Join_OpportunityStage_Previous_with_Opp_Amount_Product"]},"Extract_Event":{"action":"sobjectDigest","parameters":{"fields":[{"name":"OwnerId"},{"name":"CreatedDate__c"},{"firstDayOfWeek":0,"fiscalMonthOffset":0,"name":"LastModifiedDate"},{"firstDayOfWeek":0,"fiscalMonthOffset":0,"name":"ActivityDate"},{"name":"Subject"},{"name":"DurationInMinutes"},{"name":"EventSubtype"},{"name":"WhatId"},{"name":"AccountId"}],"object":"Event","passthroughFilter":"External_ID__c LIKE 'W_Sales_Event.%'"}},"Flatten_UserRole":{"action":"flatten","parameters":{"multiField":{"isSystemField":false,"label":"Roles","name":"Roles"},"parentField":"ParentRoleId","pathField":{"isSystemField":false,"label":"RolePath","name":"RolePath"},"selfField":"Id"},"sources":["Join_RoleUser"]},"Join_OpportunityStage_Previous":{"action":"augment","parameters":{"leftKey":["StageNamePrev"],"relationship":"StagePrev","rightKey":["MasterLabel"],"rightSelect":["IsClosed","IsWon","SortOrder"]},"sources":["Join_OpportunityStage","Extract_OpportunityStage"]},"Join_CaseAccount":{"action":"augment","parameters":{"leftKey":["AccountId"],"relationship":"Account","rightKey":["Id"],"rightSelect":["Name","Type","Industry","BillingState","ShippingState","AccountSource","NumberOfEmployees","AnnualRevenue","OwnerId","Owner.Name","Owner.UserManager.Name","Owner.UserManagerNames","Owner.UserManager.UniqueUserName","Owner.UniqueUserName","Owner.Role.Name","Owner.Role.Roles","Owner.Role.RolePath","Owner.Role.ParentRoleId"]},"sources":["compute_CalculatedCaseDuration","Join_AccountOwner"]},"Extract_OpportunityAmount":{"action":"sobjectDigest","parameters":{"fields":[{"name":"Id"},{"name":"Amount"}],"object":"Opportunity","passthroughFilter":"External_ID__c LIKE 'W_Opportunity.%'","runtime":{"SFDCtoken":"SFDCtoken"}}},"Extract_User":{"action":"sobjectDigest","parameters":{"fields":[{"name":"Id"},{"name":"Username"},{"name":"Name"},{"name":"FirstName"},{"name":"LastName"},{"name":"UserRoleId"},{"name":"UserType"},{"name":"IsActive"},{"name":"FullPhotoUrl"},{"name":"SmallPhotoUrl"},{"name":"ForecastEnabled"},{"defaultValue":"N/A","name":"ManagerId"}],"object":"User","runtime":{"SFDCtoken":"SFDCtoken"}}},"add_standard_Extract_Opportunity":{"action":"computeExpression","parameters":{"computedFields":[{"format":"yyyy-MM-dd'T'HH:mm:ss.SSS'Z'","label":"CreatedDate","name":"CreatedDate","saqlExpression":"toDate(DateTimeCreated__c, \"yyyy-MM-dd'T'HH:mm:ss.SSS'Z'\")","type":"Date"},{"format":"yyyy-MM-dd","label":"LastActivity","name":"LastActivityDate","saqlExpression":"toDate(LastActivityDate__c, \"yyyy-MM-dd\")","type":"Date"},{"format":"yyyy-MM-dd'T'HH:mm:ss.SSS'Z'","label":"LastModifiedDate","name":"LastModifiedDate","saqlExpression":"toDate(LastModifiedDate__c, \"yyyy-MM-dd'T'HH:mm:ss.SSS'Z'\")","type":"Date"}],"mergeWithSource":true},"sources":["Extract_Opportunity"]},"Flatten_UserManager":{"action":"flatten","parameters":{"includeSelfId":true,"multiField":{"isSystemField":false,"label":"UserManagerNames","name":"UserManagerNames"},"parentField":"UserManager.UniqueUserName","pathField":{"isSystemField":false,"label":"ManagerNamesPath","name":"ManagerNamesPath"},"selfField":"UniqueUserName"},"sources":["Join_User_Manager"]},"Join_OpportunityLineItemPricebookEntryProduct":{"action":"augment","parameters":{"leftKey":["Pricebook.Product2Id"],"relationship":"Product","rightKey":["Id"],"rightSelect":["ProductCode","Name","Family"]},"sources":["Join_OpportunityLineItemPricebookEntry","Extract_Product"]},"Compute_AdditionalFieldsForLead":{"action":"computeExpression","parameters":{"computedFields":[{"defaultValue":"0","label":"Lead Age in Days","name":"LeadAge","precision":18,"saqlExpression":"case when ('IsConverted' == \"false\") then daysBetween(toDate(CreatedDate_sec_epoch), now())  else daysBetween(toDate(ConvertedDate_day_epoch), toDate(CreatedDate_day_epoch))  end","scale":2,"type":"Numeric"},{"defaultValue":"0","label":"Total Opportunity Age","name":"OpportunityAge","precision":18,"saqlExpression":"case when ('ConvertedOpportunity.Name' is null) then 0 when ('ConvertedOpportunity.IsClosed' == \"false\") then ('CurrentDate_sec_epoch' - 'CreatedDate_sec_epoch')/86400  else ('ConvertedOpportunity.CloseDate_sec_epoch' - 'CreatedDate_sec_epoch')/86400 end","scale":2,"type":"Numeric"}],"mergeWithSource":true},"sources":["Join_LeadOwnerOpportunityAccount"]},"Extract_Queue":{"action":"sobjectDigest","parameters":{"fields":[{"name":"Id"},{"name":"Name"},{"name":"Type"}],"object":"Group","passthroughFilter":"Type = 'Queue'"}},"Register_OpportunityProducts":{"action":"register","parameters":{"label":"Oppty Products","name":"opportunity_products","rowLevelSecurityFilter":"'Opportunity.Owner.Role.Roles' == \"$User.UserRoleId\" || 'Opportunity.OwnerId' == \"$User.Id\" || 'Opportunity.Account.OwnerId' == \"$User.Id\"","runtime":{"SFDCtoken":"SFDCtoken"}},"sources":["Filter_Opportunity_Products"]},"Filter_UserManager":{"action":"filter","parameters":{"filter":"CustomFilter:EQ:true"},"sources":["Users_Custom_Filter_Flag"]},"Register_UserManager":{"action":"register","parameters":{"label":"Users","name":"user","rowLevelSecurityFilter":"'Role.Roles' == \"$User.UserRoleId\" || 'Id' == \"$User.Id\"","runtime":{"SFDCtoken":"SFDCtoken"}},"sources":["Filter_UserManager"]},"Pipeline_Trending_Stage_Conversion_Flag":{"action":"computeExpression","parameters":{"computedFields":[{"defaultValue":"\"true\"","name":"Stage_IsAdvanced","saqlExpression":"case when 'Stage.SortOrder' > 'StagePrev.SortOrder' then \"true\" else \"false\" end","type":"Text"}],"mergeWithSource":true},"sources":["Pipeline_Trending_Custom_Filter_Flag"]},"Join_ActivityOwner_Product_Opp":{"action":"augment","parameters":{"leftKey":["WhatId"],"relationship":"Opportunity","rightKey":["Id"],"rightSelect":["Id","Name","Type","OwnerId","IsWon","IsClosed","AccountId","CloseDate","StageName","CreatedDate","LeadSource","ForecastCategoryName","Account.Name","Account.Type","Account.Industry","Account.AccountSource","Account.BillingState","Account.ShippingState","Account.OwnerId","RecordTypeId","RecordType.Name","OpportunityAge","DaysSinceLastActivity","Neglected"]},"sources":["Join_ActivityOwner_Product","Join_OpportunityOwner"]},"Add_Fields_To_Oppty_Product":{"action":"computeExpression","parameters":{"computedFields":[{"label":"AccountName","name":"AccountName","saqlExpression":"'Opportunity.Account.Name'","type":"Text"}],"mergeWithSource":true},"sources":["Join_OpportunityOpportunityLineItemPricebookEntryProduct"]},"Join_ForecastingItem_Period_User":{"action":"augment","parameters":{"leftKey":["OwnerId"],"relationship":"User","rightKey":["Id"],"rightSelect":["Id","Name","Username","FullPhotoUrl","SmallPhotoUrl","UserRoleId","Role.Name","Role.DeveloperName","Role.Roles","Role.RoleNames","Role.ParentRoleId","Role.ParentRole.Name","Role.ParentRole.DeveloperName","Role.ParentRole.ForecastManager.Name","Role.ParentRole.ForecastManager.UniqueUserName","Role.ForecastManager.Name","Role.ForecastManager.UniqueUserName","ForecastEnabled","UniqueUserName"]},"sources":["Join_ForecastingItem_Period","User_with_Roles"]},"Extract_ForecastingQuota":{"action":"sobjectDigest","parameters":{"fields":[{"name":"Id"},{"name":"ForecastingTypeId"},{"name":"QuotaAmount"},{"name":"QuotaOwnerId"},{"firstDayOfWeek":0,"fiscalMonthOffset":0,"name":"StartDate"}],"object":"ForecastingQuota","runtime":{"SFDCtoken":"SFDCtoken"}}},"add_standard_Extract_Task":{"action":"computeExpression","parameters":{"computedFields":[{"format":"yyyy-MM-dd'T'HH:mm:ss.SSS'Z'","label":"CreatedDate","name":"CreatedDate","saqlExpression":"toDate(CreatedDate__c, \"yyyy-MM-dd'T'HH:mm:ss.SSS'Z'\")","type":"Date"}],"mergeWithSource":true},"sources":["Extract_Task"]},"Filter_For_Forecast_Users":{"action":"filter","parameters":{"filter":"ForecastEnabled:EQ:true"},"sources":["Compute_Manager_Unique"]},"Extract_ForecastingItem":{"action":"sobjectDigest","parameters":{"fields":[{"name":"Id"},{"name":"AmountWithoutAdjustments"},{"name":"AmountWithoutManagerAdjustment"},{"name":"ForecastAmount"},{"name":"ForecastCategoryName"},{"name":"ForecastingItemCategory"},{"name":"HasAdjustment"},{"name":"HasOwnerAdjustment"},{"name":"OwnerId"},{"name":"PeriodId"},{"name":"ForecastingTypeId"}],"object":"ForecastingItem","runtime":{"SFDCtoken":"SFDCtoken"}}},"add_standard_Extract_Event":{"action":"computeExpression","parameters":{"computedFields":[{"format":"yyyy-MM-dd'T'HH:mm:ss.SSS'Z'","label":"CreatedDate","name":"CreatedDate","saqlExpression":"toDate(CreatedDate__c, \"yyyy-MM-dd'T'HH:mm:ss.SSS'Z'\")","type":"Date"}],"mergeWithSource":true},"sources":["Extract_Event"]},"Extract_OpportunityHistory":{"action":"sobjectDigest","parameters":{"fields":[{"description":"Amount","label":"Amount","name":"Amount__c"},{"name":"CloseDate__c"},{"name":"CreatedById"},{"description":"Opportunity Created Date","format":"yyyy-MM-dd'T'HH:mm:ss.SSS'Z'","label":"Created Date","name":"CreatedDate__c"},{"name":"ForecastCategory__c"},{"name":"Id"},{"name":"IsDeleted"},{"name":"OpportunityId__c"},{"name":"StageName__c"}],"object":"OpportunityHistory__c","passthroughFilter":"External_Id__c LIKE 'W_OpportunityHistory.%'"}},"Extract_OpportunityLineItem":{"action":"sobjectDigest","parameters":{"fields":[{"name":"OpportunityId"},{"name":"ProductCode"},{"name":"ListPrice"},{"name":"Quantity"},{"name":"TotalPrice"},{"name":"PricebookEntryId"}],"object":"OpportunityLineItem","passthroughFilter":"External_Id__c LIKE 'W_OpportunityLineItem.%'","runtime":{"SFDCtoken":"SFDCtoken"}}},"Filter_Pipeline_Trending":{"action":"filter","parameters":{"filter":"CustomFilter:EQ:true"},"sources":["Pipeline_Trending_Stage_Conversion_Flag"]},"Join_ForecastingItem_Period_User_Type":{"action":"augment","parameters":{"leftKey":["ForecastingTypeId"],"relationship":"ForecastingType","rightKey":["Id"],"rightSelect":["DeveloperName","MasterLabel"]},"sources":["Join_ForecastingItem_Period_User","Extract_ForecastingType"]},"Register_Pipeline_Trending":{"action":"register","parameters":{"label":"Pipeline Trending","name":"pipeline_trending","rowLevelSecurityFilter":"'Opportunity.Owner.Role.Roles' == \"$User.UserRoleId\" || 'Opportunity.OwnerId' == \"$User.Id\" || 'Opportunity.Account.OwnerId' == \"$User.Id\""},"sources":["Filter_Pipeline_Trending"]},"Filter_Out_Last_Stage_Updates":{"action":"filter","parameters":{"filter":"IsLastStageUpdate:EQ:1"},"sources":["Create_IsLastStageUpdate_Field"]},"Join_ActivityOwner":{"action":"augment","parameters":{"leftKey":["OwnerId"],"relationship":"Owner","rightKey":["Id"],"rightSelect":["Name","Username","UserRoleId","UserManager.Name","UserManagerNames","UniqueUserName","UserManager.UniqueUserName","FullPhotoUrl","SmallPhotoUrl","Role.Name","Role.DeveloperName","Role.Roles","Role.RolePath","Role.ParentRoleId","Role.ParentRole.Name","Role.ParentRole.DeveloperName","Role.RoleNames","Role.RoleNamesPath"]},"sources":["Append_TaskEvent","User_with_Roles"]},"Register_Opportunity":{"action":"register","parameters":{"label":"Opportunities","name":"opportunity","rowLevelSecurityFilter":"'Owner.Role.Roles' == \"$User.UserRoleId\" || 'OwnerId' == \"$User.Id\" || 'Account.OwnerId' == \"$User.Id\"","runtime":{"SFDCtoken":"SFDCtoken"}},"sources":["Filter_Opportunity"]},"Filter_Activity":{"action":"filter","parameters":{"filter":"CustomFilter:EQ:true"},"sources":["Activity_Custom_Filter_Flag"]},"Join_Time_In_Current_Stage_to_Opportunity":{"action":"augment","parameters":{"leftKey":["Id"],"relationship":"Time_In_Current_Stage","rightKey":["OpportunityId"],"rightSelect":["Duration_Seconds"]},"sources":["Join_OpportunityRecordType","Calculate_Current_Stage_Duration"]},"Filter_WonOppty":{"action":"filter","parameters":{"filter":"IsWon:EQ:true"},"sources":["Join_OpportunityAccount"]},"Add_Neglected_To_Opportunity":{"action":"computeExpression","parameters":{"computedFields":[{"label":"Neglected","name":"Neglected","saqlExpression":"case when DaysSinceLastActivity >= 60 then \"true\" else \"false\" end","type":"Text"}],"mergeWithSource":true},"sources":["Add_Fields_To_Opportunity"]},"Register_Lead":{"action":"register","parameters":{"label":"Leads","name":"lead","rowLevelSecurityFilter":"'IsConverted' == \"false\" || 'ConvertedOpportunity.Owner.Role.Roles' == \"$User.UserRoleId\" || 'ConvertedOpportunity.OwnerId' == \"$User.Id\" || 'ConvertedAccount.OwnerId' == \"$User.Id\"","runtime":{"SFDCtoken":"SFDCtoken"}},"sources":["Compute_AdditionalFieldsForLead"]},"add_standard_Extract_Case":{"action":"computeExpression","parameters":{"computedFields":[{"format":"yyyy-MM-dd'T'HH:mm:ss.SSS'Z'","label":"CreatedDate","name":"CreatedDate","saqlExpression":"toDate(CreatedDate__c, \"yyyy-MM-dd'T'HH:mm:ss.SSS'Z'\")","type":"Date"},{"format":"yyyy-MM-dd'T'HH:mm:ss.SSS'Z'","label":"Closed Date","name":"ClosedDate","saqlExpression":"toDate(ClosedDate__c, \"yyyy-MM-dd'T'HH:mm:ss.SSS'Z'\")","type":"Date"}],"mergeWithSource":true},"sources":["Extract_Case"]},"Find_Last_Stage_Updates":{"action":"computeRelative","parameters":{"computedFields":[{"description":"Final Stage Change Id","expression":{"offset":"first()","sourceField":"Id","default":"current()"},"label":"LastStageUpdate_Id","name":"LastStageUpdate_Id"}],"orderBy":[{"direction":"desc","name":"CreatedDate"}],"partitionBy":["OpportunityId"]},"sources":["Filter_Out_Stage_Updates"]},"Account_Custom_Filter_Flag":{"action":"computeExpression","parameters":{"computedFields":[{"name":"CustomFilter","saqlExpression":"\"true\"","type":"Text"}],"mergeWithSource":true},"sources":["Join_AccountOwner"]},"compute_CalculatedCaseDuration":{"action":"computeExpression","parameters":{"computedFields":[{"defaultValue":"0","label":"Case Duration","name":"DurationCalculatedField","precision":18,"saqlExpression":"case  when ('IsClosed' == \"true\") then ('ClosedDate_sec_epoch' - 'CreatedDate_sec_epoch')/86400   else ('CurrentDate_sec_epoch' - 'CreatedDate_sec_epoch')/86400  end","scale":2,"type":"Numeric"}],"mergeWithSource":true},"sources":["compute_CurrentDateForCase"]},"Join_LeadOwnerOpportunityAccount":{"action":"augment","parameters":{"leftKey":["ConvertedAccountId"],"relationship":"ConvertedAccount","rightKey":["Id"],"rightSelect":["Name","Type","Industry","BillingState","ShippingState","AccountSource","NumberOfEmployees","AnnualRevenue","OwnerId","Owner.Name","Owner.UserManager.Name","Owner.UserManagerNames","Owner.UserManager.UniqueUserName","Owner.UniqueUserName","Owner.Role.Name","Owner.Role.Roles","Owner.Role.RolePath","Owner.Role.ParentRoleId"]},"sources":["Join_LeadOwnerOpportunity","Join_AccountOwner"]},"Activity_Custom_Filter_Flag":{"action":"computeExpression","parameters":{"computedFields":[{"name":"CustomFilter","saqlExpression":"\"true\"","type":"Text"}],"mergeWithSource":true},"sources":["Compute_Activity_Days_Overdue"]},"Join_OpportunityStage_Previous_with_Opp_Amount_Product":{"action":"augment","parameters":{"leftKey":["OpportunityId"],"operation":"LookupMultiValue","relationship":"Opportunity","rightKey":["OpportunityId"],"rightSelect":["Product.Family","Product.Name"]},"sources":["Join_OpportunityStage_Previous_with_Opp_Amount","Join_OpportunityOpportunityLineItemPricebookEntryProduct"]},"Extract_Period":{"action":"sobjectDigest","parameters":{"fields":[{"name":"Id"},{"firstDayOfWeek":0,"fiscalMonthOffset":0,"name":"StartDate"},{"firstDayOfWeek":0,"fiscalMonthOffset":0,"name":"EndDate"},{"name":"FiscalYearSettingsId"},{"name":"IsForecastPeriod"},{"name":"Type"}],"object":"Period","runtime":{"SFDCtoken":"SFDCtoken"}}},"Create_StageName_Multi_Value_Key":{"action":"augment","parameters":{"leftKey":["Id"],"operation":"LookupMultiValue","relationship":"Stage","rightKey":["OpportunityId"],"rightSelect":["StageName","IsPushed","IsPulled"]},"sources":["Join_Time_In_Current_Stage_to_Opportunity","Join_OpportunityStage_Previous"]},"Join_OpportunityOpportunityLineItemPricebookEntryProduct":{"action":"augment","parameters":{"leftKey":["OpportunityId"],"relationship":"Opportunity","rightKey":["Id"],"rightSelect":["Name","StageName","CloseDate","IsWon","Type","IsClosed","LeadSource","ForecastCategory","ForecastCategoryName","CreatedDate","AccountId","Account.Name","Account.OwnerId","Account.Type","Account.Industry","Account.BillingState","Account.ShippingState","Account.AccountSource","Account.NumberOfEmployees","Account.AnnualRevenue","Account.Owner.Name","Account.Owner.UniqueUserName","Account.Owner.Role.Name","Account.Owner.Role.Roles","Account.Owner.Role.RolePath","OwnerId","Owner.Name","Owner.FullPhotoUrl","Owner.SmallPhotoUrl","Owner.UserManager.Name","Owner.UserManagerNames","Owner.UserManager.UniqueUserName","Owner.UniqueUserName","Owner.Role.Name","Owner.Role.DeveloperName","Owner.Role.Roles","Owner.Role.RoleNames","Owner.Role.RolePath","Owner.Role.ParentRoleId","Owner.Role.ParentRole.DeveloperName","RecordTypeId","RecordType.Name","OpportunityAge","DaysSinceLastActivity","Neglected"]},"sources":["Join_OpportunityLineItemPricebookEntryProduct","Join_OpportunityOwner"]},"Join_ForecastingItem_Period":{"action":"augment","parameters":{"leftKey":["PeriodId"],"relationship":"Period","rightKey":["Id"],"rightSelect":["StartDate","EndDate","FiscalYearSettingsId","IsForecastPeriod","Type"]},"sources":["Extract_ForecastingItem","Extract_Period"]},"add_standard_Extract_Lead":{"action":"computeExpression","parameters":{"computedFields":[{"format":"yyyy-MM-dd","label":"CreatedDate","name":"CreatedDate","saqlExpression":"toDate(CreatedDate__c, \"yyyy-MM-dd\")","type":"Date"},{"format":"yyyy-MM-dd","label":"Converted Date","name":"ConvertedDate","saqlExpression":"toDate(ConvertedDate__c, \"yyyy-MM-dd\")","type":"Date"}],"mergeWithSource":true},"sources":["Extract_Lead"]},"Add_Fields_To_Task":{"action":"computeExpression","parameters":{"computedFields":[{"label":"EventSubtype","name":"EventSubtype","saqlExpression":"TaskSubtype","type":"Text"},{"defaultValue":"0","label":"DurationInMinutes","name":"DurationInMinutes","precision":8,"saqlExpression":"0","scale":0,"type":"Numeric"}],"mergeWithSource":true},"sources":["add_standard_Extract_Task"]},"Join_OpportunityOwner_Product":{"action":"augment","parameters":{"leftKey":["Id"],"operation":"LookupMultiValue","relationship":"Product","rightKey":["OpportunityId"],"rightSelect":["Product.Family","Product.Name"]},"sources":["Join_OpportunityOwner","Join_OpportunityOpportunityLineItemPricebookEntryProduct"]},"Add_Fields_To_Opportunity":{"action":"computeExpression","parameters":{"computedFields":[{"label":"Days Since Last Activity","name":"DaysSinceLastActivity","precision":8,"saqlExpression":"case    when LastActivityDate is null      then daysBetween(toDate(LastModifiedDate_sec_epoch), now())   when LastModifiedDate > LastActivityDate     then daysBetween(toDate(LastModifiedDate_sec_epoch), now())   else daysBetween(toDate(LastActivityDate_sec_epoch), now()) end","scale":0,"type":"Numeric"},{"label":"Opportunity Age","name":"OpportunityAge","precision":8,"saqlExpression":"case    when IsClosed == \"false\"     then daysBetween(toDate(CreatedDate_sec_epoch), now())     else daysBetween(toDate(CreatedDate_sec_epoch),toDate(CloseDate_sec_epoch))     end","scale":0,"type":"Numeric"}],"mergeWithSource":true},"sources":["add_standard_Extract_Opportunity"]},"Opportunity_Products_Custom_Filter_Flag":{"action":"computeExpression","parameters":{"computedFields":[{"name":"CustomFilter","saqlExpression":"\"true\"","type":"Text"}],"mergeWithSource":true},"sources":["Join_OpportunityOpportunityLineItemPricebookEntryProduct"]},"Register_Case":{"action":"register","parameters":{"label":"Cases","name":"case","rowLevelSecurityFilter":"","runtime":{"SFDCtoken":"SFDCtoken"}},"sources":["Join_CaseAccount_Oppty"]},"Extract_ForecastingType":{"action":"sobjectDigest","parameters":{"fields":[{"name":"Id"},{"name":"DeveloperName"},{"name":"MasterLabel"},{"name":"IsAmount"},{"name":"IsQuantity"},{"name":"IsActive"}],"object":"ForecastingType","runtime":{"SFDCtoken":"SFDCtoken"}}},"User_with_Roles_with_Opportunities":{"action":"augment","parameters":{"leftKey":["Id"],"relationship":"Opportunity","rightKey":["OwnerId"],"rightSelect":["Name"]},"sources":["User_with_Roles","add_standard_Extract_Opportunity"]}}}